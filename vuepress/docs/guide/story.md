# 企业数字化协同门户 
# ( BizLink---B2B Document Exchange )

## 基础

### 缘起

企业在业务往来中， 经常需与业务伙伴进行各类业务单据的协作： 
如A 企业向B 企业采购一批货物时： 
A 企业会创建销售合同，订单，发货，发票，收款单等一系列业务单据。 
B 企业会形成对应采购合同，订单， 收货，发票，付款等单据。
这些单据存在对应的关系， 如：A 企业的销售订单与B 企业的采购订单往往是相对的。
为提高协同的效率，减少人工操作失误，企业间可进行业务数据交换处理，将A 企业的销售单转化B企业的采购单，不要双方单独重复输入。

EDI(Electronic Data Interchange )电子数据交换就是提供企业之间业务数据的交换处理技术。 
EDI 软件将A 企业的单据从ERP 中获取，转化为符合EDI规范标准文档， 再通过网络传递到B 企业，
B 企业将标准文档转化为自身ERP 格式，在导入ERP。 反之亦然（B企业到A 企业）。
 EDI 规范包括各类文档标准及网络通信协议。 理论上各企业遵从EDI 的规范，就可以和多个合作伙伴进行数据交换。
市场上各类EDI 软件（如：WebMethod， BizTalk， Welink Gateway）等提供EDI 规范实现， 并提供定制开发功能。

 
EDI 技术在国内并未得到广泛应用，主要问题是实施EDI成本比较高。 EDI 实施成本主要有软件成本，人员成本，定制成本。
EDI软件一般都在十万元以上， 而且EDI 技术门槛较高，需掌握较多相关的技术概念，人才缺乏是EDI 不能广泛应用的一个问题。
另外对应大部分企业来说，企业间业务单据协作， 不仅仅是系统到系统的对接，很多地方需要加入人工处理逻辑：
如订单确认，订单异议，大部分企业希望订单确认后再进入ERP，所以就还存在大量ERP 定制化的成本。
再次在EDI 技术最流行时，国内大部分企业的信息化程度不高， 只有一些大企业信息化程度比较高。
这些大企业推广EDI时就，发现大量合作业务伙伴无系统对接，或对接意愿不高。 
针对这种情况，国内只有少数大型企业之间使用EDI技术。
对于中小企业只有那些需要与国外进行业务往来，被国外合作伙伴要求才被迫使用EDI 。

 
国内企业的业务协作普遍采用的解决方案是“门户”技术，各个核心企业开发了“供应商门户”或“销售门户”，
邀请合作伙伴注册登录门户，核心企业与合作或者在门户中来完成各类业务协作。 
门户方案很好的解决了核心企业的问题，但给合作业务伙伴带来一定的麻烦：比如一个企业给多家超市供货，他就需要登录多家超市
的供应商门户系统，来完成订单，送货，结算等操作， 同时手工将这些协作的结果反馈到ERP中， 这样不仅操作麻烦， 人工错误失误多，而且实时性无法保证。


针对这种情况，对应少量的时效性要求重要合作伙伴， 核心企业通过API 接口技术进行对接。 API 接口技术与EDI 技术相比较，
更实时，但API 接口模式缺乏行业标准，往往需要与每个合作伙伴一一对接。 但由于本来就是只处理少量重要客户，相对EDI 来说，成本更低。
但对于对于大量合作伙伴来说，成本实际更高。


对于中小企业来说， 随着这几年国内企业信息化程度的提高， 传统“门户” +API 方案的不足之处就更加凸显。 有一种新的“RPA”（Robotic Process Automation）
技术出现，对这个问题有一定的解决。 RPA 技术就是通过计算机模拟人工操作，登录门户，将门户中的数据爬下来，然后进行处理。 但RPA 技术整体来说，是一种无奈之举，不是一个完整端对端的解决方案，
 只能作为是一种补充手段。 
 
事实上，对于大量的中小企业来说， 企业间文档交易协作的主要方式: 是通过创建Excel文档， 然后通过邮件，QQ 等工具与合作伙伴沟通交流，
然后手工将对于单据更新到ERP 中。  这种模式与现在企业数字化的建设很不相符， 急需要一种新的解决方案。
  

### 简介

Welink BizDoc（以下简称为BizDoc） 定义一种新的企业交易协同的方式，是企业B2B 业务协作平台。
核心企业和协作企业可以在平台上定制需与合作伙伴协同的文档，并进行交互协作。 
BizDoc 支持企业云部署和企业私有化部署两种方式， 并提供专业服务支持企业定制化服务。
   
BizDoc 企业交易协同网络的主要技术特点有：
*  支持系统与系统，系统与人，人与人多种方式对接

	 将人工处理和系统对接处理统一起来，在提供系统到系统的对接基础中， 扩展人与系统， 人与人的协同对接。

*  类Excel 操作方式的文档处理模式，快速上手
	
	支持通过Excel 模板来制定文档规范， 文档操作界面上类excel 风格。 
	另外可方便配置单文档或批量文档的Excel 导入和导出操作。
	与大部分企业的现有操作类似，无需学习大量新的知识，可立刻上手。

*  网络协作的数字化，流程化，时效化

	系统将Excel 内容绑定到对应数据结构上， 将传统非结构化的文档转化为结构化的数据， 
	在文档界面上支持各类预设数据的选择和自动绑定。同时在文档上可扩充各类数字操作如：电子签章，在线支付等功能。

	系统在将文档内容结构化基础中，支持定制化文档处理流程和状态。 设置文档处理的时效性，
	在有效期到期前进行提醒，逾期后可展期或自动作废。

*  内部应用快速整合
	
	系统通过开放API 或Excel 导入导出，与企业内部应用（主要是ERP）进行整合。 
	平台也预设多种应用插件（ 产品电子采购， 库存管理等）。
	可按对应业务逻辑，通过应用直接创建文档或对文档进行处理反馈。

*  区块链整合

	支持将协同文档写入区块链，保证企业协同的文档可追溯,无法篡改，伪造。

### 快速了解

#### 企业注册
 注册页面
 欢迎查看
 	
#### 合作伙伴

创建合作伙伴
系统预制文档

#### 创建并发送文档

#### 合作伙伴查看文档

#### 合作伙伴反馈

## 深入了解
下面将从
-  文档定义
-  企业设置
-  业务伙伴
-  合作伙伴协同


等方面一一展开介绍BizDoc 的如何配置企业间往来文档。


### 文档定义

在业务协作中， 由于行业不同，各个企业业务处理流程和逻辑不同，需提供能定制化文档处理的功能。 

#### 系统预制文档
系统预制相关文档
包括销售方面：
- 销售合同
- 销售订单
- 销售收发货
- 销售发票
- 销售收款
- 其他销售文档

采购方面：
- 采购合同
- 采购订单
- 采购收发货
- 采购发票
- 采购付款
- 其他采购文档

等文档。 企业可以直接启用预制文档，或这些文档作为基础快速构建自身的文档。


#### 文档模板

支持Excel 表单型模板和Word 文字型的模板（下个版本，用于合同签署等情况下使用）

Excel 表单型支持导入已有的Excel 文件直接做为模板。也支持直接在界面上编辑设置模板， 
支持定义边线，文字格式，公式等各种类Excel 操作方式。
（todo:补充图片）



#### 属性字段及与模板内容绑定

除了模板，我们还需要完善属性字段定义：
文档属性字段是多个字段的合集（实际也就是后面说的记录类型），
每个字段定义包括：名称（英文名称)，标签(中文名称), 类型，说明，是否必须有内容， 子类型等。
不同类型可设置子类型（编辑类型）不同，另外还有一些对应类型特定的定义：

属性字段支持下列类型：
- 字符串(String)
- 日期(Date)
- 数字(Number)
- 记录(Record)
- 列表(List)
- 引用(Ref）

对于字符串类型来说，子类型可支持单行文本，多行文本，下拉选择， 并可设置选择中的可选值等。 
对于日期类型的子类型来说，支持纯日期(Date)，时间（Time），日期加时间（DateTime）等子类型。并可设置显示格式如："yyyy-MM-DD"等。
对于数字类型来说： 支持：数字，货币等子类型，并可设置小数精度(几位小数)

记录是一组字段定义的合集，可以包含字符串，日期，也可以包含记录和列表。
列表就是记录的数组： 当记录内容可多次重复，如订单明细行，这类字段类型就是列表。  

引用字段定义有特定的意义， 列表和记录中都可以包括零个或多个引用字段。 
所谓的引用是指数据关联到系统预设的信息，如订单明细中就会关联到产品。
当记录中或列表中，设置了引用字段， 其他的字段（比如String）就可以设置它自身关联应用字段和关联引用内容。 
举例说明：在订单明细列表中， 有一个关联产品的引用字段product， 
那么在明细列表中产品名称，关联引用字段product，关联内容为产品表中的产品名称。


当一个字段设置了引用关联后， 在编辑状态下编辑到该字段时，在工具栏会出现对应的选择按钮。
如：订单明细行的产品名称字段设置产品的引用关联后，在编辑时，工具栏显示产品选择按钮。 
选择了产品后， 订单明细行中产品名称的值就自动为刚才选择的产品，引用字段值自动为系统产品的主键。
（todo: 补充图片）


引用字段本身可设置过滤器，过滤器中设置对应系统预设信息字段，
等于某个固定值或记录（列表）对应的某个字段值。满足过滤器的条件值才可选择。
引用字段存储内容为选择内容的主键（待确定：是否可设置不存储？），

文档模板内容与属性字段可进行绑定。
系统支持从模板绑定属性字段， 也可以从属性字段绑定当前选中的字段。
操作上，就是选择模板对应内容，在右边上选择自动创建按钮或在对应字段上点击绑定按钮。
模板选择内容可以是记录，列表，或字符串，日期，数字等字段，系统进行智能判断。


重要说明：
1. 系统预制文档定义了基本的缺省字段，（预制字段中的关键的字段-是不可以删除），用户可在系统缺省字段上进行扩展。
2. 实际无需将文档模板内的各种内容都设置对应的属性字段， 只需要将关键字段结构化，数字化的内容进行绑定。


完成了模板和属性字段绑定设置， 当我们新建文档或者编辑文档，文档内容将自动结构化。 
在编辑时，可用系统预设的内容进行选择输入。 
反之也依然：如我们导入批量结构数据（API 对接或Excel导入），我们也能形成基于模板对应文档内容。


#### 文档状态图

在企业文档往来协作中， 还需管理文档状态，并控制在对应状态上可进行的操作。
系统使用文档状态图来描述上述逻辑定义。状态图包括状态节点和文档操作连线。 
节点描述文档的状态， 对文档进行某个操作后，文档就进入新的状态。 

我们先从文档规范（就是文档模板，文档属性等内容）创建者角度来说，
为简化称呼，后面我们将称文档规范的创建者为核心企业，遵从核心企业文档规范的企业为合作伙伴。

创建文档时，可选择”核心企业发送文档“，”核心接收文档“，两种模式。
针对这两种模式系统提供缺省的状态节点和缺省操作，用户可以其商扩展性的状态和操作。

我们先从**核心企业发送文档**的流程来说，主要状态节点包括：

- 文档开始
- 内部处理
- 文档已发送（待合作伙伴处理）
- 文档逾期
- 文档异议
- 文档确认
- 文档结束

（todo: 补充图）
  
  所有流程从文档开始节点启动，开始节点后，可以“新建/导入或应用创建” 操作变化为：内部处理。 
  开始节点中可设置支持操作，-新建，导入，应用创建。 可设置各操作是否启用， 操作对象：本企业/合作伙伴。 
  并提供对应设置如导入--对应设置，批量导入--对应设置， 应用创建-选择对应应用。 

  内部处理文档在再内部进行流转， 审批。可开启支持多人协同。  内部文档-进行发送后，状态变化文档已发送（合作伙伴接收）。

  在合作伙伴接收的节点上，可以进行时限设置，即文档反馈的有效期。 是否支持手工展期。 最多可展期次数。 
  除了时效设置外， 可支持操作绑定确认，异议，付款，或其他外部应用整合（如聚合支付）， 合同签署等。

  在合作伙伴接收节点如发生逾期了，状态进入：文档逾期。 文档逾期可设置是否支持展期， 支持代客户处理， 逾期直接作废。
  
  文档异议：如合作伙伴异议， 可作废此文档，或将文档重新编辑处理，转化为内部处理状态。
  
  文档确认：当合作伙伴确认文档或通过应用确认， 接收后，可绑定内部操作，对文档进行转换。或同步到内部系统中。完成后进入文档结束状态

除了核心企业创建文档流程外， **核心企业接收文档** 的流程也类似，主要状态包括：

- 文档开始
- 合作伙伴处理
- 文档已接收
- 文档逾期
- 文档异议
- 文档确认
- 文档结束

（todo: 补充图）


  不论哪种流程， 都可在流程每个操作上，设置是否为流程主线， 流程主线用于在文档协作时，显示后续需完成的操作。
（todo:补充文档明细查看图）
  开始-内部处理-合作伙伴接收--合作伙伴确认-


#### 文档操作
在流程不同状态上，可进行各类操作，这些操作可分为：

- 新建文档

	新建文档。
	参数：文档模板名称，权限角色

- Excel 导入

	支持单笔或批量导入， 
	参数：设置：单笔/批量, 设置：导入模板与属性字段映射关系（可按属性字段自动生成导入模板）

- 编辑
	
	对文档进行修改编辑。
	参数：文档模板名称，权限角色
	
- 转发

	支持文档发送给本企业的其他人员， 由接收人员进行处理。如接收人员未处理，支持撤回。
	参数：无
	
- 审批
	
	支持文档发送给本企业的其他人员审批。 审批和转发的差异，是审批不修改内容，只反馈确认或大会。
	如审批人员尚未审核时，支持撤回。

- 发送

	发送本文档给合作伙伴， 发送具体方式，根据合作伙伴设置来确定（可发送给人，或系统）
	
- 确认

	合作伙伴接收文档后确认内容。
	
- 异议

	合作伙伴接收文档反馈异议。 异议不能在文档上直接修改（如需支持直接修改，请使用应用插件）
	
- 文档转换

	提供将本文档转换为另一个文档。
	参数： 另一个文档名称， 一对一映射，还是一对多，多对一映射。 两个文档的映射关系
	
- 其他自定义操作（下个版本）

- 应用插件（参考应用插件描述）
	* 电子签章
	* 付款
	* 其他


在文档连线中，可配置一个或多个的对应的文档操作。
为美化图表显示，对应自循环操作可设置在节点中。（ 即操作后状态不变的操作，就在节点内进行设置）

在不同状态下进行操作时，可设置使用不同的文档模板，所以在文档模板创建中，除了缺省模板。 
还可在其上自定义多个模板并赋予名称，在操作设置是，可配置使用对应的模板。

（todo: 节点编辑说明）


### 企业设置
前面说的引用字段类型，引用的内容主要就是企业设置和合作伙伴设置中的信息，
通过预设这类信息，方便文档创建和编辑中的数据选择和数据校验。

#### 商品信息

在各类文档中，经常需要引用企业的商品信息的内容。 所以可以事先维护好商品信息，在各类文档中引用。
同时商品信息也是支撑应用插件中多个应用的基础信息。 如订货门户，库存管理等。

##### 商品分类及属性模板
系统支持多级的树状商品分类设置， 商品只能挂在末级分类上。
为满足各行业特征，可在商品分类可设置此分类的属性模板。
属性模板包括系统预设基础属性，可扩充自身的属性。
每个分类可设置对应属性模板，子分类如没设置属性模板，集成父目录属性模板
 
##### 商品属性
系统基础的商品属性有：
- 商品名称
- 商品编码
- 商品分类
- 规格型号
- 单位
- 销售单价
- 状态
- 商品图片（多个）
- 商品说明 （富文档)


**商品单位**
系统预设常用商品单位， 也可扩展自定义，单位可定义精度， 为简化，此版本商品只支持一个单位。

系统也预设一些可扩充属性如：
- 商品条码
- 保质期
- 箱条码
- 箱装数
- 最小采购量

##### 商品多规格（下个版本）
支持商品可维护多个规格（SPU-SKU）。规格项目中支持多个规格项（在分类属性设置中，设置）。


#### 企业信息

维护管理企业的相关信息

##### 组织机构
企业注册后，系统缺省为创建总部组织机构。
系统支持按树状结构创建多组织，多部门的支持，支持在文档中选择对应组织。 

组织信息：
- 组织名称
- 类型（总部，分公司，自定义）
- 联系人
- 地址

##### 企业联系人
设置企业联系人，包括

- 所属组织
- 姓名
- 职务
- 手机
- 邮件
- 上级领导
- 状态：启用/禁用
- 开通账号：此人是否开通系统账号。



##### 仓库设置
设置企业下的仓库信息，主要包括：
- 仓库名称
- 仓库编号
- 仓库类型
- 仓库地址
- 联系人
- 联系电话
- 所属组织

** 仓库类型 **：可支持：物流仓，虚拟仓，在途仓，第三方仓等多种，更详细说明请参考：库存管理插件。
** 所属组织 **：可限定查看所属组织。
（待讨论： 支持多个销售组织，采购组织--复杂了），

##### 收款账户
配置企业的收款账户，包括：
- 所属组织（一个组织可有多个账户）
- 账户名称
- 账户账号
- 开户行
- 银联号
- 状态：启用/禁用

##### 开票信息


##### 组织相关自定义信息（下个版本）
支持企业自定义更多信息，这些信息第一个字段为：所属组织. 已支持文档中更多引用的使用（父组织的各项数据？？）。



#### 数据字典

数据字典就是与组织无关的各类列表信息，供文档编辑时引用。
系统提供一些预设的数据字典的内容，也支持企业自定义新的数据项

预设的数据字典内容
- 发票类别
- 支付方式
- 税率
- 付款约定
- 物流方式



### 业务伙伴
定义文档后，在创建和发送文档之前，还需要设置业务伙伴， 业务伙伴设置包括设置业务伙伴的基础信息和业务设置：

说明： 本文档中业务伙伴概念和合作伙伴稍有不同，合作伙伴和核心企业是一对。 
业务伙伴-就是与自己进行业务协作的企业，这个企业可能是核心企业（文档规格由核心企业定义），也可能是合作伙伴。 
我们先从核心企业角度来看。

#### 基础信息

**业务伙伴类型** 支持多级设置，如客户，供应商，物流服务等
客户下有可分为：经销商，批发商，终端门店等等。

app-todo：提供树状结构定义业务伙伴类型。

**业务伙伴的基础信息** 
就是文档属性字段定义中的引用字段， 当文档创建或接收后，自动绑定业务伙伴，就可以引用对应的内容。
这些信息主要包括
- 企业信息

	包括企业名称， 企业编码，企业证件， 企业地址信息等	

- 联系人

	业务伙伴的联系人（多个）
	包括联系人的：姓名，手机，邮箱，备注（app-todo），激活状态，激活账号（可为合作伙伴配置账号）
	
- 收发货地址

	记录企业收发货地址。 在业务单据可选择此地址
	主要包括：地区，详细地址，联系人，手机号，备注（app-todo）。 
	
- 账户信息

	记录企业收付款账户。
	主要包括： 类型，开户行，户名，账号，备注

- 发票信息

	对应企业的开票信息，主要包括：发票类型，抬头类型，发票抬头，税号，开户行，银行账号，企业地址，企业电话。
	注：发票类型决定哪些字段是必须的。

- 关联企业（下个版本)

	定义企业相关企业。
	主要字段包括： 相关关系（主要有上级/下级），企业。

以上信息可除上述描述的标准字段外，还可设置扩展字段（app-todo）。或自定义其他信息（下个版本）

#### 业务设置
业务伙伴业务设置中，可包括
- 所属组织设置
	
	定义合作伙伴所属本企业的哪个组织，ERP 编码，我方业务负责人等。

- 贸易关系设置	
    分为核心企业和合作伙伴两种情况（合作伙伴说明参看合作伙伴门户）
	+ 文档设置
	定义与此业务伙伴往来文档，有：文档名称，核心企业，对接方式名称，说明。

- 通讯设置
	详细定义对接方式说支持配置，系统支持通讯方式
	* 系统对接
	* API
	* AS2
	* SFTP
	
	对应API，AS2，SFTP等外部通讯方式，可添加多种，不同文档通过名称，对应特定的连接方式。
	并可设置定时器，定时接收文档。
	（todo：待补充细化通讯详细设置，以及方向，定时触发等功能）
	

### 文档协同

#### 新建文档
#### 文档明细
#### 文档活动
#### 文档事项
#### 文档列表
#### 首页
#### 业务统计

#### 业务预警





	

### 合作伙伴门户
前面讨论的主要核心企业如何设置文档的规范，下面从合作伙伴角度来谈文档的设置。


 
#### 合作伙伴邀请和激活
核心企业定义好文档，设置业务伙伴后，
核心企业也可以不需要等待合作伙伴激活，就可以支持直接向合作伙伴发送文档。
如合作伙伴是使用外部通讯方式，无需激活。

如设置为系统对接，如合作伙伴没有激活，需要业务人员手工发送文档链接或合作伙伴邀请链接。

合作伙伴点击文档链接，可直接查看"文档内容“ 或按流程定义“创建文档”，完成文档的相关注册，而无需激活自身的账号
但这样核心企业每次有新的文档，就需要手工通过微信或者邮件发送文档链接。 而且合作伙伴每次使用这个链接，只能看到当前文档，
无法查看历史文档，也无法对文档进行其他处理。

系统会引导合作伙伴进行激活，
合作伙伴激活是，需设置自身企业的信息，并和查看核心企业设置与他协作的各种文档。
他可在这些文档上进行设置，配置自身接收或发送文档的处理流程和操作。

合作伙伴激活后，系统对接模式的文档就能自动发送和接收。一般来说，无需再用微信或邮件发送文档链接。
系统还是支持手工发送链接，用于催促业务伙伴及时处理文档。

对应已激活的合作伙伴企业，在收到邀请时，如已有账号，可用已有账号登录。系统将在合作伙伴的企业中，添加新的业务伙伴。
并提醒此企业进行业务设置。

#### 未激活文档查看

#### 激活后文档协同

#### 激活后的文档处理
当添加一个新的核心企业作为业务伙伴后， 系统将会自动根据核心企业的文档定义转换合作伙伴定义的文档定义。
主要包括：
- 文档模板

	将按照核心企业的设置，不提供修改。	

- 属性字段

	不可直接修改核心企业定义的属性字段，但支持扩展新的字段和调整字段引用值。
	
	缺省字段引用值以核心企业定义为准，但合作伙伴可更改为自己的引用字段（必须符合核心企业-值选项检查）
	
	
- 状态和操作

	支持接收文档，转换为标准文档：系统会根据核心企业创建文档时，对应的标准文档名称，形成缺省文档对应关系。
	如核心企业对文档
	通过此方法， 支持合作伙伴将不同核心企业的文档
	

（未来版本可能考虑扩展-子流程功能，可在子流程中当做另一个文档进行处理，处理完转换为核心企业文档）

### 应用组的管理

企业-作为合作伙伴角色时，为每个核心企业创建一个应用组，同时提供一个自身作为核心企业的应用组。

系统支持在接收文档业务处理后，将核心企业发生文档进行数据转换，存放如本企业应用组的对应数据中。




### 系统管理

#### 内部系统整合
#### 接口开通
#### Excel 处理
#### 加速器

#### 应用插件
   * 应用设置
    * 订货门户
    * 库存管理
    * 客户往来
    * 信用管理
    * 收付款管理
      + 在线收款
    * 发票管理
      + 电子发票
    * 合同管理
      + 电子签章
    *应用插件（ 外部应用整合：页面整合，url 整合，）
	
### 系统设置
#### 用户管理
#### 系统接口
#### 个人设置


## 架构说明

## 桌面客户端
